{
  "hash": "8186eaaf995d7ffc8a021f1cf0d249d3",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: Arizona Aquifer Recharge Suitability Analysis\nauthor:\n  - name: Travis Zalesky\n    orcid: 0009-0006-0181-3099\n    corresponding: true\n    email: travisz@arizona.edu\n    roles:\n      - Author\n      - GIST Software and Applications\n      - Cartography\n      - Suitability Analysis\n    affiliations: University of Arizona\nkeywords:\n  - Arizona Tri University Recharge (ATUR)\n  - water table\n  - ground water\nabstract: |\n  Aquifer recharge can be either passive or active, and is implemented in a variety of ways. This analysis seeks to identify regions across AZ which are broadly suitable for aquifer recharge projects as a general template for more focused analysis.\nplain-language-summary: |\n  Identifying regions in AZ where surface water can be stored long-term as ground water.\nkey-points:\n  #| TODO\ndate: last-modified\nbibliography: references.bib\n#| citation:\n  #| container-title: Earth and Space Science\nnumber-sections: true\njupyter: python3\n---\n\n\n\n\n\n## Update 5-21-25 (TCZ)\n**This analysis has been taken over by Ryan Lima who has developed the Soil Moisture Infiltration Index (SMII) and Subsurface Infiltration Index (SbII). This page is no longer being updated and is being maintained for archival purposes only. See [ATUR Thinning to enhance Recharge](https://ryan3lima.github.io/ATUR-Thinning-to-enhance-recharge/) (private repository) for updated method details.**\n\n## Introduction\n\n## Data & Methods {#sec-data-methods}\n**These methods and data layers are preliminary and subject to change**\n\n### Elevation\n\n#### DEM\nElevation and elevation derivatives from 30-m NASA SRTM. USGS 3-DEM (10m) product not suitable for full study area analysis due to (1) the large area of missing data in Mexico, and (2), the excessively high spatial resolution (massively increasing computational requirements).\n\nSRTM elevation sinks filled prior to calculating slope and aspect.\n\n**Should elevation be directly used in the suitability analysis?**\n\n#### Slope\nSlope derived from hydrologically conditioned (filled) 30-m SRTM layer using quadratic surface function and a fixed 30-m neighborhood. Slope measured in °.\n\n> Higher slopes are less suitable because thinning is both more expensive and more precipitation will end up as runoff.\n\nSlope classified from 1-10 using a **continuous function** in ArcPro Suitability Mapper.\n\nParameter|Setting\n:-------:|:-------------:\nFunction|[MSSSmall](https://pro.arcgis.com/en/pro-app/latest/tool-reference/spatial-analyst/the-transformation-functions-available-for-rescale-by-function.htm#ESRI_SECTION1_6C2FDA23D8094B8F99DBF3DF5E176B1D)\nMean multiplier|1\nSddv multiplier|2\nLower threshold|0\nValue below threshold|0\nUpper threshold|90\nValue above threshold|0\nInvert function|FALSE\nSave transformed dataset|TRUE\nOutput|Transformed_SRTM_slope\n\n![Slope suitability mapper rescale transformation setup.](images/SuitabilityAnalysis_Transformations/Slope.png)\n\n#### Aspect\nAspect calculated as with slope. Aspect reference point at N. Pole.\n\n> Aspect has a large impact on solar radiation.\n\n> Closer to 0 or 360 is desired, low suitability scores for closeness.\n\nAspect classified from 1-10 using a **continuous function** in ArcPro Suitability Mapper.\n\nParameter|Setting\n:-------:|:-------------:\nFunction|[Near](https://pro.arcgis.com/en/pro-app/latest/tool-reference/spatial-analyst/the-transformation-functions-available-for-rescale-by-function.htm#ESRI_SECTION1_A7FC2FC126CD4A41974C8D3F5E0F8FD6)\nMid Point|180\nPoint spread|0.0011049638968393428 (default)\nLower threshold|-1 (flat)\nValue below threshold|0\nUpper threshold|360\nValue above threshold|0\nInvert function|TRUE\nSave transformed dataset|TRUE\nOutput|Transformed_SRTM_aspect\n![Aspect suitability mapper rescale transformation setup.](images/SuitabilityAnalysis_Transformations/Aspect.png)\n\n### Precipitation\nPRISM normals, 800m resolution. Annual precipitation.\n\n> Mean annual precipitation must be higher than 500mm 1990 - 2020\n\nPrecipitation classified from 1-10 using a **continuous function** in ArcPro Suitability Mapper.\n\nNOTE: The logistic growth function may also be a good choice for this dataset. See [Logistic Growth function](https://pro.arcgis.com/en/pro-app/latest/tool-reference/spatial-analyst/the-transformation-functions-available-for-rescale-by-function.htm#ESRI_SECTION1_76ED0A2D02A24C95B98B8A691603F2F4)\n\nParameter|Setting\n:-------:|:-------------:\nFunction|[MSLarge](https://pro.arcgis.com/en/pro-app/latest/tool-reference/spatial-analyst/the-transformation-functions-available-for-rescale-by-function.htm#ESRI_SECTION1_B83C9047549542DE995823E6030A29F3)\nMean multiplier|1.68 (approximates 500mm at x-intercept)\nSddv multiplier|1\nLower threshold|67.33789825439453 (default, minimum)\nValue below threshold|0\nUpper threshold|1214.5689697265625 (default, maximum)\nValue above threshold|0\nInvert function|FALSE\nSave transformed dataset|TRUE\nOutput|Transformed_PRISM_ppt_30yrnormal_800m\n\n![Aspect suitability mapper rescale transformation setup.](images/SuitabilityAnalysis_Transformations/Precip_PRISM.png)\n\n### Vegetation Characteristics\n\n#### NLCD 2021 Total Canopy Cover\n\n#### Landfire\n\n### Soil Hydrology\nAZ_Soil_Hydric_Group data layer\n\n**Classification Schema**\n\n| Class | Count (pixels) | Text | Value |\n|:-----:|:-----:|:---------------------:|:-----:|\n|A|62559472|Group A soils consist of deep, well drained sands or gravelly sands with high infiltration and low runoff rates.|10|\n|B|76665198|Group B soils consist of deep well drained soils with a moderately fine to moderately coarse texture and a moderate rate of infiltration and runoff.|8|\n|C|88491710|Group C consists of soils with a layer that impedes the downward movement of water or fine textured soils and a slow rate of infiltration.|5|\n|D|155095790|Group D consists of soils with a very slow infiltration rate and high runoff potential. This group is composed of clays that have a high shrink-swell potential, soils with a high water table, soils that have a clay pan or clay layer at or near the surface, and soils that are shallow over nearly impervious material.|2|\n|A/D|43192|Group A/D soils naturally have a very slow infiltration rate due to a high water table but will have high infiltration and low runoff rates if drained.|7|\n|B/D|18456|Group B/D soils naturally have a very slow infiltration rate due to a high water table but will have a moderate rate of infiltration and runoff if drained.|6|\n|C/D|217771|Group C/D soils naturally have a very slow infiltration rate due to a high water table but will have a slow rate of infiltration if drained.|3|\n\n*Transformed dataset* Transformed_AZ_Soil_Hydric_Group\n\n### Depth to Bedrock\n**There are 2 data layers which represent depth to bedrock and it is not clear which data layer is preferred!**\n\n* AZ_BedrockDepth_cm.tif\n  + 218 m resolution\n  + UTM 12N, NAVD88 depth (m) positive down\n  + 0 -- 108,273 cm\n\n![AZ_BedrockDepth_cm.tif with histogram.](images/Depth_to_Bedrock/AZ_BedrockDepth_cm.png)\n\n* Depth to Bedrock WTA\n  + Classified\n  + 30 m resolution\n  + UTM 12N, NAVD88 height (m) positive up\n    - vertical datum is incorrect. Should be depth (m) positive down\n  + 0 -- 269 cm\n  + Extremely skewed distribution clustering around 200 cm\n\n![Depth to Bedrock WTA, DEP2BEDRS_WTA layer with histogram](images/Depth_to_Bedrock/Depth_to_Bedrock_WTA.png)\n\n#### Soil vs. Subsurface Geology Weighting Layers\nTo quantify the differential importance of soils vs. subsurface geology layers for determining suitability two related data layers had to be calculated.\n\nThe logic assumes that there are two uniform subsurface layers, soil, and subsurface geology (i.e. geology). However, the weighted importance of these layers is not uniform across space. Where the bedrock is close to the surface, we assume that the soil is the most important layer for ground water storage. Inversely, when the bedrock is extremely deep, we assume that the geology is the more important layer. Our soil layer is measured at a depth of 200cm (2m), and we assume a uniform soil depth across the state. Therefore, the depth to bedrock was divided by 200 to get a depth to bedrock (dtb) in soil units. The first \"soil depth\" was ascribed to the soil layer, and varies from 0 to 1, while the remaining \"soil depth\" were attributed to the geology layer, with a range from 0 to 541. Ergo, where the bedrock is deepest, the geology layer is 541 time more influential than the soils layer.\n\n![Simple diagram of logic underlying the soil vs. subsurface geology weighting layers.](images/Depth_to_Bedrock/Notes.jpg)\n\nThese layers were created in a custom R script using the following raster math, with their resulting outputs.\n\n##### Soils\n```{{r}}\n# Where depth to bedrock (dtb) = 0cm, soil multiplier = 0 (no soil)\n# Where depth to dtb >= 200cm, soil multiplier = 1 (Full depth of soil)\n# Intermediate depths = linear\nsoilMultiplier = masked\nsoilMultiplier[soilMultiplier > 200] = 200  # Fix upper limit of soil depth = 200 cm\nsoilMultiplier = soilMultiplier/200\n```\n\n![Soils multiplier layer.](images/Depth_to_Bedrock/SoilsMultiplier.png)\n\n##### Geology\n```{{r}}\n# Where dtb < 200cm, geology multiplier = 0 (soil only)\n# Where dtb >= 200cm, geology multiplier = dtb/200 (in units of relative soil depth)\ngeologyMultiplier = masked\ngeologyMultiplier[geologyMultiplier < 200] = 0\ngeologyMultiplier = geologyMultiplier/200\n```\n\n![Geology multiplier layer.](images/Depth_to_Bedrock/GeologyMultiplier.png)\n\n### Other Data Layers for Consideration\n\n#### Global Hydrologic Curve Number(GCN250)\nhttps://gee-community-catalog.org/projects/gcn250/?h=hydrologic\n\n> The GCN250 is a globally consistent, gridded dataset defining CNs at the **250 m spatial resolution** from new global land cover (300 m) and soils data (250 m). GCN250 **represents runoff** for a combination of the European space agency global land cover dataset for 2015 (ESA CCI-LC) resampled to 250 m and geo-registered with the hydrologic soil group global data product (HYSOGs250m) released in 2018. The **potential application** of this data includes **hydrologic design**, land management applications, flood risk assessment, and **groundwater recharge modeling**. The CN values vary depending on antecedent runoff conditions (ARC), which is affected by the rainfall intensity and duration, total rainfall, soil moisture conditions, cover density, stage of growth, and temperature[.] \n*emphasis mine*\n\n#### Soil Properties 800m\nhttps://gee-community-catalog.org/projects/soilprop/?h=\n\n> The data shown here were obtained by aggregating current USDA-NCSS soil survey data (SSURGO back-filled with STATSGO where SSURGO is not available) within **800m² grid cells**. This data aggregation technique results in maps that may not match the original data at any given point, and is **intended to depict regional trends in soil properties at the statewide scale**. \n*emphasis mine*\n\n* Pros:\n  + Lots of relevant data layers, such as:\n    - Avail. Water Holding Capacity\n    - Drainage Class\n    - Sat. Hyd. Conductivity \n    - Depth to Restrictive Layer\n    - Hydrologic Group\n    - Soil Depth\n    - etc.\n* Cons:\n  + 800m resolution\n  + Large data gaps (layer dependent)\n\n##### Alternative layers\n[gNATSGO (gridded National Soil Survey Geographic Database)](https://gee-community-catalog.org/projects/gnatsgo/)\n\n* Pros:\n  + Authoritative\n  + Source layer for value added products (including Soil Properties 800m)\n  + 10m resolution\n* Cons:\n  + Large data gaps across AZ\n  + 10m resolution\n\n[Polaris 30m Probabilistic Soil Properties US](https://gee-community-catalog.org/projects/polaris/)\n\n* Pros: \n  + Continuous data availability (no gaps)\n  + 30m resolution\n* Cons: \n  + Fewer data layers\n  + Probabilistic model (increased uncertainty)\n\n#### Leaf Area Index (LAI)\nLeaf Area Index (LAI) can be calculated from Landsat data (30 m resolution), as a proxy of land cover. LAI is a unitless index value which is calculated as a function of the Enhanced Vegetation Index (ENVI) and typically ranges from 0 to 3.5 (*citation needed*). LAI can be calculated efficiently over a large spatial scale in Google Earth Engine (GEE) using the Javascript API, however LAI will vary seasonally, with updated Landsat data available every 8-days. Additionally, due to our large study area, as well as the logistics of Landsat orbital paths, it takes 6 days to photograph the entire study area. Therefore, any LAI analysis on this scale will necessarily be a mosaic image, over roughly a week. For these reasons, a single LAI image should be viewed with some skepticism, and a seasonal mean or median LAI mosaic image may be more desirable as a proxy for land cover.\n\nCode is available for calculating LAI from Landsat 8/9 imagery in my personal GEE scripts folder, which could be easily modified for purpose. Due to the large number of Landsat images involved the study period must be narrowed prior to analysis (i.e. July LAI, Winter LAI, etc.). Additional post-processing of LAI images may be required outside of GEE.\n\n##### Google Earth Engine LAI Javascript Code\n\n\n\n\n\n```{js}\nvar studyArea = ee.FeatureCollection(\"projects/ee-travisz09/assets/ATUR/WBDHU8_OuterBoundary_Project\"),\n    landsat9 = ee.ImageCollection(\"LANDSAT/LC09/C02/T1_TOA\");\n\n// Map setup\nMap.centerObject(studyArea, 6);\nMap.addLayer(studyArea, {}, 'Study Area', false);\n\n// Paint study area outline\nvar empty = ee.Image().byte();  // An empty layer to paint on\nvar studyAreaOutline = empty.paint(studyArea, 'black', 2);\nMap.addLayer(studyAreaOutline, {}, 'Study Area (outline)');\n\n// Study period\nvar startDate = ee.Date('2023-01-01');\nvar endDate = ee.Date('2024-01-01');  // Exclusive end date\nvar timeDif = endDate.difference(startDate, 'day');\n// var interval = 8;  // days\n// print(timeDif);\n\n// Landsat 8/9\nvar cloudFilter = 10  // 10% max cloud cover\nvar landsat = ee.ImageCollection('LANDSAT/LC08/C02/T1_L2')\n  .merge(ee.ImageCollection('LANDSAT/LC09/C02/T1_L2'))  // Combine Lst-9 and Lst-8\n  .filterDate(startDate, endDate)\n  .filterBounds(studyArea)\n  .sort('system:time_start')  // Sort by date\n  .filter(ee.Filter.lt('CLOUD_COVER', cloudFilter));\n  \n// Lst scaling factor function\nvar scaleLst = function(col) {\n  // Map over images in collection\n  var scaled = col.map(function(img) {\n    var opticalBands = img.select('SR_B.').multiply(0.0000275).add(-0.2);\n    var thermalBands = img.select('ST_B.*').multiply(0.00341802).add(149.0);\n    \n    return img.addBands(opticalBands, null, true)  // Overwrite unscaled bands\n      .addBands(thermalBands, null, true);\n  });\n  \n  return scaled;\n};\n\n// print(landsat.first());  // Check the Lst data before scaling\nlandsat = scaleLst(landsat);  // Apply scaling factor\n// print(landsat.first());  // Check Lst data after scaling\n\n// NDVI, EVI, LAI, index function\nvar calcIndices = function(col) {\n  var indices = col.map(function(img) {\n    var ndvi = img.normalizedDifference(['SR_B5', 'SR_B4'])\n      .rename('ndvi');\n    var evi = img.expression(\n      '2.5 * ((nir - red) / (nir + 6 * red - 7.5 * blue + 1))',\n      {\n        'nir': img.select('SR_B5'),\n        'red': img.select('SR_B4'),\n        'blue': img.select('SR_B2')\n      }).rename('evi');\n    var lai = evi.expression(\n      '3.618 * evi - 0.118', \n      {\n        'evi': evi.select('evi')\n      }).rename('lai');\n      \n    return img.addBands(ndvi)\n      .addBands(evi)\n      .addBands(lai);\n  });\n  \n  return indices;\n};\n\n// Apply indices\nlandsat = calcIndices(landsat);\n// print(landsat.first());  // sanity check\n\n// Isolate lai bands\nvar lai = landsat.map(function(img) {\n  return img.select('lai');\n});\n\nMap.addLayer(lai.limit(20), {\n  min: 0,\n  max: 3.5,\n  palette: ['red', 'white', 'green']\n}, 'LAI');\nprint(lai);\n```\n\n\n\n\n\n\n## Conclusion {#sec-conclusions}\n\n## References {.unnumbered}\n\n",
    "supporting": [
      "index_files\\figure-docx"
    ],
    "filters": []
  }
}